# DO NOT EDIT THIS FILE -- edit Makefile and use "make depend"
# PAM Samples - prom configuration utility
#
# Copyright 1997 Digital Equipment Corporation.
# Distributed only by permission.
# Last modified on Tue Dec  2 06:58:42 1997 by moll

VPATH=.

CFLAGS = -oldcxx -nopt -g
C2OFLAGS = -c

PAMDCLIB = -lPamDC -lm

DESIGN_NAME = cordic
DES_OBJ_FILES = Design.o 
DES_SRC_FILES = Design.cxx 
DCF_FILES = $(DESIGN_NAME)10e.dcf $(DESIGN_NAME)20e.dcf

PPRCMD= xnfmerge $* && \
	xnfprep $* && \
	ppr $*

MAKEBIT_OPT = -f cclk_nosync -f CRC:Enable -f DonePin:Pullup \
	-f ReadCapture:Enable -f ReadAbort:Enable -f ReadClk:Cclk \
	-f DoneActive:C4 -f OutputsActive:C3 -f GSRInactive:C4


.SUFFIXES:
.SUFFIXES: .oldxnf .xnf .lca .rbt .cxx .o


#************************************************************
# DESIGN

all: makefile \
	$(DCF_FILES) \
	lca0-10e.xnf lca0-10e.oldxnf lca0-10e.lca lca0-10e.rbt \
	lca1-10e.xnf lca1-10e.oldxnf lca1-10e.lca lca1-10e.rbt \
	lcaem10e.xnf lcaem10e.oldxnf lcaem10e.lca lcaem10e.rbt \
	lca0-20e.xnf lca0-20e.oldxnf lca0-20e.lca lca0-20e.rbt \
	lca1-20e.xnf lca1-20e.oldxnf lca1-20e.lca lca1-20e.rbt \
	lcaem20e.xnf lcaem20e.oldxnf lcaem20e.lca lcaem20e.rbt \
	$(DESIGN_NAME)_pam.c 

$(DESIGN_NAME)_pam.c: $(DCF_FILES) 
	mergebit -c $(DESIGN_NAME) -o $(DESIGN_NAME)_pam.c $(DESIGN_NAME)10e $(DESIGN_NAME)20e

Design: $(DES_OBJ_FILES)
	cxx $(CFLAGS) $(DES_OBJ_FILES) $(PAMDESLDFLAGS) $(PAMDCLIB) -o Design

$(DCF_FILES): Design
	Design

lca0-10e.xnf: $(DESIGN_NAME)10e.dcf
	dcf2xnf -input $(DESIGN_NAME)10e.dcf

lca0-20e.xnf: $(DESIGN_NAME)20e.dcf
	dcf2xnf -input $(DESIGN_NAME)20e.dcf

makefile: Makefile
	@echo "Running \"make depend\""
	$(MAKE) depend
	$(MAKE)

#************************************************************
.xnf.oldxnf:
	diffxnf $*

.oldxnf.lca:
	$(PPRCMD)

.lca.rbt:
	makebits -b $(MAKEBIT_OPT) $*


.cxx.o:
	cxx $(CFLAGS) $(PAMINCLUDE) $(C2OFLAGS) $<

#************************************************************
tidy:
	rm -f ,* .,* *~ a.out core

clean: tidy
	rm -f *.o *.map *.bib *.bid *.dbk *.lcb *.rpf *.rpt *.log Design
	rm -f *.bit *.mbo *.xrp *.dly


scratch: clean
	rm -f *.dcf
	rm -f *.mrg *.oldxnf *.prp *.tsi *.xff *.xtf *.xnf *.lca
	rm -f *.rbt *.mergebit
	rm -f ppr.log xnfprep.log
	rm -f *.pam *_pam.c



#-----------------------------------------------------------------------------

depend:
	make -f Makefile _depend

_depend:
	echo '# DO NOT EDIT THIS FILE -- edit Makefile and use "make depend"' \
	| cat - Makefile > mktemp
	echo '#--DO NOT CHANGE ANYTHING AFTER THIS LINE' >>mktemp
	for file in $(DES_SRC_FILES); do 			\
		echo "dependencies for $$file ..." ;	\
		cxx -M $(CFLAGS) $(PAMINCLUDE) $(VPATH)/$$file | grep -v /usr/include >> mktemp ;	\
		echo "" >> mktemp ;			\
	done
	mv -f mktemp makefile
	chmod 444 makefile

# ------------------------------------------------------------------------------
# Dependencies
# ------------------------------------------------------------------------------
#--DO NOT CHANGE ANYTHING AFTER THIS LINE
#--DO NOT CHANGE ANYTHING AFTER THIS LINE
Design.o:	./Design.cxx
Design.o:	./../../inc/cordic.h
Design.o:	   ./../../inc/pamblox.h
Design.o:	      ./../../inc/pamtypes.h

